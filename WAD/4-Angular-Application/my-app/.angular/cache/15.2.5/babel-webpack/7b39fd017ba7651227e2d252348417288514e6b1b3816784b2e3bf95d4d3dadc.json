{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"ngx-cookie-service\";\nimport * as i2 from \"@angular/router\";\nexport class HomeComponent {\n  constructor(cookieService, router) {\n    this.cookieService = cookieService;\n    this.router = router;\n    let user = localStorage.getItem('user') ?? '{}';\n    const userDetails = JSON.parse(user);\n    this.message = userDetails.username ? 'Hello ' + userDetails.username : 'LOGIN';\n    this.validate();\n  }\n  validate() {\n    // verify\n    const jwt = this.cookieService.get('jwt');\n    console.log(jwt);\n    const myHeaders = new Headers({\n      'Content-Type': 'application/json',\n      Cookie: `jwt=${jwt}`\n    });\n    var requestOptions = {\n      method: 'GET',\n      headers: myHeaders,\n      redirect: 'follow',\n      credentials: 'include'\n    };\n    fetch('http://localhost:2324', requestOptions).then(response => {\n      if (!response.ok) {\n        throw new Error(String(response.status));\n      }\n      return response.json();\n    }).then(result => {\n      console.log(result);\n      if (result.message == 'Token is not valid') {\n        // redirect to login\n        localStorage.removeItem('user');\n        this.router.navigate(['/login']);\n      } else if (result.message == 'Token is not provided') {\n        // redirect to login\n        localStorage.removeItem('user');\n        this.router.navigate(['/login']);\n      }\n      if (this.message == 'LOGIN') {\n        this.router.navigate(['/login']);\n      }\n    }).catch(error => console.log('error', error));\n  }\n  logout() {\n    localStorage.removeItem('user');\n    this.router.navigate(['/login']);\n  }\n}\nHomeComponent.ɵfac = function HomeComponent_Factory(t) {\n  return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.CookieService), i0.ɵɵdirectiveInject(i2.Router));\n};\nHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HomeComponent,\n  selectors: [[\"app-home\"]],\n  decls: 5,\n  vars: 1,\n  consts: [[1, \"text-center\", \"h1\", \"m-5\"], [1, \"text-center\"], [1, \"btn\", \"btn-danger\", \"my-5\", 3, \"click\"]],\n  template: function HomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"div\", 1)(3, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function HomeComponent_Template_button_click_3_listener() {\n        return ctx.logout();\n      });\n      i0.ɵɵtext(4, \"LogOUT\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate(ctx.message);\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":";;;AASA,OAAM,MAAOA,aAAa;EAGxBC,YAAoBC,aAA4B,EAAUC,MAAc;IAApD,kBAAa,GAAbD,aAAa;IAAyB,WAAM,GAANC,MAAM;IAC9D,IAAIC,IAAI,GAAWC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI;IACvD,MAAMC,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC;IACpC,IAAI,CAACM,OAAO,GAAGH,WAAW,CAACI,QAAQ,GAC/B,QAAQ,GAAGJ,WAAW,CAACI,QAAQ,GAC/B,OAAO;IACX,IAAI,CAACC,QAAQ,EAAE;EACjB;EAEAA,QAAQ;IACN;IACA,MAAMC,GAAG,GAAG,IAAI,CAACX,aAAa,CAACY,GAAG,CAAC,KAAK,CAAC;IACzCC,OAAO,CAACC,GAAG,CAACH,GAAG,CAAC;IAChB,MAAMI,SAAS,GAAG,IAAIC,OAAO,CAAC;MAC5B,cAAc,EAAE,kBAAkB;MAClCC,MAAM,EAAE,OAAON,GAAG;KACnB,CAAC;IAEF,IAAIO,cAAc,GAAW;MAC3BC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAEL,SAAS;MAClBM,QAAQ,EAAE,QAAQ;MAClBC,WAAW,EAAE;KACd;IAEDC,KAAK,CAAC,uBAAuB,EAAEL,cAAc,CAAC,CAC3CM,IAAI,CAAEC,QAAQ,IAAI;MACjB,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAACC,MAAM,CAACH,QAAQ,CAACI,MAAM,CAAC,CAAC;;MAE1C,OAAOJ,QAAQ,CAACK,IAAI,EAAE;IACxB,CAAC,CAAC,CACDN,IAAI,CAAEO,MAAM,IAAI;MACflB,OAAO,CAACC,GAAG,CAACiB,MAAM,CAAC;MACnB,IAAIA,MAAM,CAACvB,OAAO,IAAI,oBAAoB,EAAE;QAC1C;QACAL,YAAY,CAAC6B,UAAU,CAAC,MAAM,CAAC;QAC/B,IAAI,CAAC/B,MAAM,CAACgC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;OACjC,MAAM,IAAIF,MAAM,CAACvB,OAAO,IAAI,uBAAuB,EAAE;QACpD;QACAL,YAAY,CAAC6B,UAAU,CAAC,MAAM,CAAC;QAC/B,IAAI,CAAC/B,MAAM,CAACgC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;MAElC,IAAI,IAAI,CAACzB,OAAO,IAAI,OAAO,EAAE;QAC3B,IAAI,CAACP,MAAM,CAACgC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;IAEpC,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAKtB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEqB,KAAK,CAAC,CAAC;EAClD;EAEAC,MAAM;IACJjC,YAAY,CAAC6B,UAAU,CAAC,MAAM,CAAC;IAC/B,IAAI,CAAC/B,MAAM,CAACgC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;EAClC;;AAxDWnC,aAAa;mBAAbA,aAAa;AAAA;AAAbA,aAAa;QAAbA,aAAa;EAAAuC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCT1BC,4BAA8B;MAAAA,YAAa;MAAAA,iBAAI;MAC/CA,8BAAyB;MACaA;QAAA,OAASC,YAAQ;MAAA,EAAC;MAACD,sBAAM;MAAAA,iBAAS;;;MAF1CA,eAAa;MAAbA,iCAAa","names":["HomeComponent","constructor","cookieService","router","user","localStorage","getItem","userDetails","JSON","parse","message","username","validate","jwt","get","console","log","myHeaders","Headers","Cookie","requestOptions","method","headers","redirect","credentials","fetch","then","response","ok","Error","String","status","json","result","removeItem","navigate","catch","error","logout","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\jayal\\Downloads\\SPPU-WADL-Assignment-master\\SPPU-WADL-Assignment-master\\Practical\\4-Angular-Application\\my-app\\src\\app\\home\\home.component.ts","C:\\Users\\jayal\\Downloads\\SPPU-WADL-Assignment-master\\SPPU-WADL-Assignment-master\\Practical\\4-Angular-Application\\my-app\\src\\app\\home\\home.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { CookieService } from 'ngx-cookie-service';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.component.html',\n  styleUrls: ['./home.component.css'],\n})\nexport class HomeComponent {\n  message: string;\n\n  constructor(private cookieService: CookieService, private router: Router) {\n    let user: string = localStorage.getItem('user') ?? '{}';\n    const userDetails = JSON.parse(user);\n    this.message = userDetails.username\n      ? 'Hello ' + userDetails.username\n      : 'LOGIN';\n    this.validate();\n  }\n\n  validate() {\n    // verify\n    const jwt = this.cookieService.get('jwt');\n    console.log(jwt);\n    const myHeaders = new Headers({\n      'Content-Type': 'application/json',\n      Cookie: `jwt=${jwt}`,\n    });\n\n    var requestOptions: Object = {\n      method: 'GET',\n      headers: myHeaders,\n      redirect: 'follow',\n      credentials: 'include',\n    };\n\n    fetch('http://localhost:2324', requestOptions)\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(String(response.status));\n        }\n        return response.json();\n      })\n      .then((result) => {\n        console.log(result);\n        if (result.message == 'Token is not valid') {\n          // redirect to login\n          localStorage.removeItem('user');\n          this.router.navigate(['/login']);\n        } else if (result.message == 'Token is not provided') {\n          // redirect to login\n          localStorage.removeItem('user');\n          this.router.navigate(['/login']);\n        }\n        if (this.message == 'LOGIN') {\n          this.router.navigate(['/login']);\n        }\n      })\n      .catch((error) => console.log('error', error));\n  }\n\n  logout() {\n    localStorage.removeItem('user');\n    this.router.navigate(['/login']);\n  }\n}\n","<p class=\"text-center h1 m-5\">{{ message }}</p>\n<div class=\"text-center\">\n  <button class=\"btn btn-danger my-5\" (click)=\"logout()\">LogOUT</button>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}